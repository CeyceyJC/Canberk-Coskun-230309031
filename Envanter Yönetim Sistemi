//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

public interface Storable {
    String toCSVRow();
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

public class Supplier {

    private String supplierId;
    private String name;
    private String email;
    private String phone;

    public Supplier(String supplierId, String name, String email, String phone) {
        this.supplierId = supplierId;
        this.name = name;
        this.email = email;
        this.phone = phone;
    }

    public String getSupplierId() {
        return supplierId;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

public abstract class Product {
    private String id;
    private String name;
    private double unitPrice;
    private int quantity;

    public Product(String id, String name, double unitPrice, int quantity) {
        this.id = id;
        this.name = name;
        this.unitPrice = unitPrice;
        this.quantity = quantity;
    }

    public abstract String getTypeCode();
    public String getExpiryDate() { return ""; }

    public String getId() { return id; }
    public String getName() { return name; }
    public double getUnitPrice() { return unitPrice; }
    public int getQuantity() { return quantity; }

    public void setName(String name) { this.name = name; }
    public void setUnitPrice(double unitPrice) { this.unitPrice = unitPrice; }
    public void setQuantity(int quantity) { this.quantity = quantity; }

    public void addStock(int amount) {
        quantity += amount;
    }

    public boolean reduceStock(int amount) {
        if (quantity >= amount) {
            quantity -= amount;
            return true;
        }
        return false;
    }

    public String stockWarning() {
        if (quantity < 5) return "!!! KRITIK STOK (5'ten az) !!!";
        if (quantity < 10) return "!! AZ STOK (10'dan az) !!";
        return "";
    }

    @Override
    public String toString() {
        String exp = getExpiryDate();
        String expText = exp.equals("") ? "" : (" | SKT: " + exp);
        String warn = stockWarning();
        String warnText = warn.equals("") ? "" : (" | " + warn);

        return getId() + " (" + getTypeCode() + ") - " + getName()
                + " | Fiyat: " + getUnitPrice()
                + " | Adet: " + getQuantity()
                + expText
                + warnText;
    }
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

public class NormalProduct extends Product {

    public NormalProduct(String id, String name, double unitPrice, int quantity) {
        super(id, name, unitPrice, quantity);
    }

    @Override
    public String getTypeCode() {
        return "NP";
    }

    @Override
    public String toCSVRow() {
        return getId() + "," + getTypeCode() + "," + getName() + "," + getUnitPrice() + "," + getQuantity() + ",";
    }
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

public class PerishableProduct extends Product {
    private String expiryDate;

    public PerishableProduct(String id, String name, double unitPrice, int quantity, String expiryDate) {
        super(id, name, unitPrice, quantity);
        this.expiryDate = expiryDate;
    }

    @Override
    public String getTypeCode() {
        return "PP";
    }

    @Override
    public String getExpiryDate() {
        return expiryDate;
    }

    public void setExpiryDate(String expiryDate) {
        this.expiryDate = expiryDate;
    }

    @Override
    public String toCSVRow() {
        return getId() + "," + getTypeCode() + "," + getName() + "," + getUnitPrice() + "," + getQuantity() + "," + expiryDate;
    }
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

public class Order {
    private String date;
    private String type;
    private String productId;
    private String productName;
    private int quantity;
    private double unitPrice;
    private double total;
    private String supplierName;

    public Order(String date, String type, String productId, String productName,
                 int quantity, double unitPrice, String supplierName) {
        this.date = date;
        this.type = type;
        this.productId = productId;
        this.productName = productName;
        this.quantity = quantity;
        this.unitPrice = unitPrice;
        this.total = quantity * unitPrice;
        this.supplierName = supplierName;
    }

    public String getDate() { return date; }
    public String toCSVRow() {
        return date + "," + type + "," + productId + "," + productName + "," + quantity + "," + unitPrice + "," + total + "," + supplierName;
    }

    public void printReceipt() {
        System.out.println("\n==============================");
        System.out.println(type.equals("BUY") ? "         ALIS FISI" : "         SATIS FISI");
        System.out.println("------------------------------");
        System.out.println("Tarih       : " + date);
        System.out.println("Urun ID     : " + productId);
        System.out.println("Urun Adi    : " + productName);
        System.out.println("Adet        : " + quantity);
        System.out.println("Birim Fiyat : " + unitPrice);
        System.out.println("Toplam      : " + total);
        System.out.println("Tedarikci   : " + supplierName);
        System.out.println("==============================\n");
    }
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Scanner;

public class Inventory {
    private ArrayList<Product> products = new ArrayList<>();

    public ArrayList<Product> getProducts() {
        return products;
    }

    public Product findById(String id) {
        for (Product p : products) {
            if (p.getId().equalsIgnoreCase(id)) return p;
        }
        return null;
    }

    public void addOrUpdate(Product newProduct) {
        Product existing = findById(newProduct.getId());
        if (existing != null) {
            existing.addStock(newProduct.getQuantity());
            // fiyatı güncel tutmak istersen:
            existing.setUnitPrice(newProduct.getUnitPrice());
        } else {
            products.add(newProduct);
        }
    }

    public boolean sell(String id, int qty) {
        Product p = findById(id);
        if (p == null) return false;
        return p.reduceStock(qty);
    }

    public boolean updateStock(String id, int newQty) {
        Product p = findById(id);
        if (p == null) return false;
        p.setQuantity(newQty);
        return true;
    }

    public void printInventory() {
        System.out.println("\n===== ENVANTER =====");
        if (products.size() == 0) {
            System.out.println("Envanter boş.");
            return;
        }
        for (Product p : products) {
            System.out.println(p);
        }
    }

    public void ensureInventoryFile(String fileName) {
        try {
            File f = new File(fileName);
            if (!f.exists()) {
                FileWriter w = new FileWriter(fileName);
                w.write("id,type,name,unitPrice,quantity,expiryDate\n");
                w.close();
            }
        } catch (IOException e) {
            System.out.println("inventory.csv olusturulamadi!");
        }
    }

    public void loadFromCSV(String fileName) {
        File f = new File(fileName);
        if (!f.exists()) return;

        try {
            Scanner reader = new Scanner(f);

            if (reader.hasNextLine()) reader.nextLine(); // header geç

            while (reader.hasNextLine()) {
                String line = reader.nextLine();
                if (line.trim().equals("")) continue;

                String[] parts = line.split(",");
                String id = parts[0];
                String type = parts[1];
                String name = parts[2];
                double unitPrice = Double.parseDouble(parts[3]);
                int qty = Integer.parseInt(parts[4]);
                String expiry = (parts.length >= 6) ? parts[5] : "";

                if (type.equalsIgnoreCase("PP")) {
                    products.add(new PerishableProduct(id, name, unitPrice, qty, expiry));
                } else {
                    products.add(new NormalProduct(id, name, unitPrice, qty));
                }
            }
            reader.close();

        } catch (FileNotFoundException e) {
            System.out.println("Envanter dosyasi bulunamadi!");
        }
    }

    public void saveToCSV(String fileName) {
        try {
            FileWriter w = new FileWriter(fileName, false);
            w.write("id,type,name,unitPrice,quantity,expiryDate\n");

            for (Product p : products) {
                w.write(p.toCSVRow() + "\n");
            }

            w.close();
        } catch (IOException e) {
            System.out.println("Envanter dosyasina yazilamadi!");
        }
    }
}

//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

import java.util.Scanner;

public class Employee {
    protected String username;
    private String password;

    public Employee(String username, String password) {
        this.username = username;
        this.password = password;
    }

    public boolean login(Scanner input) {
        System.out.print("Kullanici adi: ");
        String u = input.nextLine();
        System.out.print("Sifre: ");
        String p = input.nextLine();

        if (u.equals(username) && p.equals(password)) {
            System.out.println("Giris basarili.\n");
            return true;
        } else {
            System.out.println("Hatali giris!\n");
            return false;
        }
    }

    public void searchProduct(Inventory inventory, Scanner input) {
        System.out.print("Aranacak urun ID: ");
        String id = input.nextLine();

        Product p = inventory.findById(id);
        if (p == null) {
            System.out.println("Urun bulunamadi!");
        } else {
            System.out.println("Bulunan urun: " + p);
        }
    }
}
